<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TicketChain - NFT Ticket Marketplace</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Load ethers.js from proven working CDN -->
    <script src="https://unpkg.com/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>
    <header>
        <h1>TicketChain</h1>
        <p>NFT-based Event Ticketing System</p>
        <div class="wallet-info">
            <p>Status: <span id="connectionStatus">Not Connected</span></p>
            <p>Wallet: <span id="walletAddress">N/A</span></p>
            <button id="connect">Connect Wallet</button>
        </div>
    </header>

    <main>
        <section class="section">
            <h2>Available Events</h2>
            <div id="eventsList" class="list-container">
                <p>No events available or wallet not connected</p>
            </div>
        </section>

        <section class="section">
            <h2>Your Tickets</h2>
            <div id="ticketsList" class="list-container">
                <p>No tickets found or wallet not connected</p>
            </div>
        </section>

        <section class="section">
            <h2>Create New Event</h2>
            <form id="createEventForm">
                <div class="form-group">
                    <label for="eventName">Event Name:</label>
                    <input type="text" id="eventName" required>
                </div>
                
                <div class="form-group">
                    <label for="eventDescription">Description:</label>
                    <textarea id="eventDescription" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="eventTicketPrice">Ticket Price (ETH):</label>
                    <input type="number" id="eventTicketPrice" step="0.01" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="eventMaxTickets">Maximum Tickets:</label>
                    <input type="number" id="eventMaxTickets" min="1" required>
                </div>
                
                <div class="form-group">
                    <label for="eventDate">Event Date:</label>
                    <input type="date" id="eventDate" required>
                </div>
                
                <div class="form-group">
                    <label for="eventTime">Event Time:</label>
                    <input type="time" id="eventTime" required>
                </div>
                
                <div class="form-group">
                    <label for="eventMinResalePrice">Minimum Resale Price (ETH):</label>
                    <input type="number" id="eventMinResalePrice" step="0.01" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="eventMaxResalePrice">Maximum Resale Price (ETH):</label>
                    <input type="number" id="eventMaxResalePrice" step="0.01" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="eventRoyaltyPercentage">Royalty Percentage (%):</label>
                    <input type="number" id="eventRoyaltyPercentage" min="0" max="100" required>
                </div>
                
                <button type="submit">Create Event</button>
                <p id="createEventStatus"></p>
            </form>
        </section>
        
        <!-- Hidden forms that appear when needed -->
        <div id="mintTicketFormContainer" class="modal-container">
            <div class="modal">
                <h2>Buy Ticket</h2>
                <p>Event: <span id="mintEventName"></span></p>
                <p>Price: <span id="mintPrice"></span> ETH</p>
                
                <form id="mintTicketForm">
                    <input type="hidden" id="mintEventId">
                    
                    <div class="form-group">
                        <label for="metadataURI">Metadata URI (optional):</label>
                        <input type="text" id="metadataURI" placeholder="ipfs://...">
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit">Buy Ticket</button>
                        <button type="button" onclick="document.getElementById('mintTicketFormContainer').style.display = 'none'">Cancel</button>
                    </div>
                    
                    <p id="mintStatus"></p>
                </form>
            </div>
        </div>
        
        <div id="resaleTicketFormContainer" class="modal-container">
            <div class="modal">
                <h2>List Ticket for Resale</h2>
                
                <form id="resaleTicketForm">
                    <input type="hidden" id="resaleTokenId">
                    
                    <div class="form-group">
                        <label for="resalePrice">Resale Price (ETH):</label>
                        <input type="number" id="resalePrice" step="0.01" min="0" required>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit">List for Resale</button>
                        <button type="button" onclick="document.getElementById('resaleTicketFormContainer').style.display = 'none'">Cancel</button>
                    </div>
                    
                    <p id="resaleStatus"></p>
                </form>
            </div>
        </div>
        
        <div id="buyTicketFormContainer" class="modal-container">
            <div class="modal">
                <h2>Buy Resale Ticket</h2>
                
                <form id="buyTicketForm">
                    <div class="form-group">
                        <label for="buyTokenId">Ticket Token ID:</label>
                        <input type="number" id="buyTokenId" min="1" required>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit">Buy Ticket</button>
                        <button type="button" onclick="document.getElementById('buyTicketFormContainer').style.display = 'none'">Cancel</button>
                    </div>
                    
                    <p id="buyStatus"></p>
                </form>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 TicketChain - A Blockchain-Based Event Ticketing System</p>
    </footer>
    
    <!-- Application code -->
    <script src="app.js"></script>
</body>
</html>
